<section>
  <div class="container">

    <!-- Post an Opportunity button -->
    <div class="row py-3">
      <div class="col">
        <button ng-if="vm.userCanAdd" class="btn btn-primary float-right" ng-class="{'btn-default': !vm.project && !vm.program, 'btn-link': vm.project || vm.program}"
          ui-sref="opportunityadmin.createlanding({programId:vm.programId, projectId:vm.projectId, programTitle:vm.programTitle, projectTitle:vm.projectTitle, context:vm.context})">
          <i class="fa fa-plus"></i> Post an Opportunity
        </button>
      </div>
    </div>

    <!-- Notify of new opportunities toggle -->
    <div class="row pt-3">
      <div class="col" ng-if="vm.isUser">
        <a class="btn btn-textonly float-right" ng-click="vm.toggleSubscription()" uib-tooltip="Click to get notified when new opportunities are posted">
          <i class="fa fa-bell fa-lg text-muted" ng-class="{'text-muted': !vm.user.notifyOpportunities, 'text-primary': vm.user.notifyOpportunities}"></i>
          <span ng-if="!vm.user.notifyOpportunities" class="text-muted">Not listening for new opportunities</span>
          <span ng-if="vm.user.notifyOpportunities">Listening for new opportunities</span>
        </a>
      </div>
    </div>
  </div>
</section>

<section>

  <!-- Loading opportunities placeholder -->
  <div class="container" ng-if="vm.isLoading">
    <div class="row">
      <div class="col px-0">
        <h6><i class="fa fa-lg fa-spinner fa-spin"></i> Loading Opportunities...</h6>
      </div>
    </div>
  </div>

  <!-- Open Opportunities List -->
  <div class="container" ng-if="!vm.isLoading">

    <div class="row">
      <div class="col px-0">
        <h6>Open Opportunities</h6>
        <h6 ng-if="vm.countOpenOpportnities() === 0">
          <emoji>ðŸŒµ</emoji> No open opportunities right now
        </h6>

        <opportunity-card class="card my-3" ng-repeat="opportunity in vm.opportunities | orderBy: 'created': true | filter: vm.filterOpen"
          opportunity="opportunity" />
      </div>
    </div>
  </div>

  <hr>

  <!-- Close Opportunities List -->
  <div class="container" ng-if="!vm.isLoading">

    <div class="row">
      <div class="col px-0">
        <h6 class="float-left">Closed Opportunities</h6>
        <h6 class="float-right">Total value: {{vm.getTotalClosedAmount() | currency}}</h6>

      </div>
    </div>

    <div class="row">
      <div class="col px-0">
        <opportunity-card class="card my-3" ng-repeat="opportunity in vm.opportunities | orderBy: 'created': true | filter: vm.filterClosed"
          opportunity="opportunity" />
      </div>
    </div>
  </div>

</section>
